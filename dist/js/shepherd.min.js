!function(t,e){"function"==typeof define&&define.amd?define(["popper"],e):"object"==typeof exports?module.exports=e(require("popper")):t.Shepherd=e(t.Popper)}(this,function(t){"use strict";function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i++){var s=arguments[i];if(null!=s)for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(n[r]=s[r])}return n}function s(t){return"undefined"==typeof t}function r(t){return t&&t.constructor===Array}function o(t){return t&&t.constructor===Object}function h(t){return"object"==typeof t}function a(t){var e=document.createElement("div");return e.innerHTML=t,e.children[0]}function c(t,e){var n=void 0;return s(t.matches)?s(t.matchesSelector)?s(t.msMatchesSelector)?s(t.webkitMatchesSelector)?s(t.mozMatchesSelector)?s(t.oMatchesSelector)||(n=t.oMatchesSelector):n=t.mozMatchesSelector:n=t.webkitMatchesSelector:n=t.msMatchesSelector:n=t.matchesSelector:n=t.matches,n.call(t,e)}function l(t){if(h(t))return t.hasOwnProperty("element")&&t.hasOwnProperty("on")?t:null;var e=v.exec(t);if(!e)return null;var n=e[2];return"["===n[0]&&(n=n.substring(1,n.length-1)),{element:e[1],on:n}}function u(t,e){if(null===t||s(t))return t;if(h(t))return t;for(var n=t.split(" "),i={},r=e.length-1,o=n.length-1;o>=0;o--){if(0===r){i[e[r]]=n.slice(0,o+1).join(" ");break}i[e[r]]=n[o],r--}return i}var p=function(t,e,n){for(var i=!0;i;){var s=t,r=e,o=n;i=!1,null===s&&(s=Function.prototype);var h=Object.getOwnPropertyDescriptor(s,r);if(void 0!==h){if("value"in h)return h.value;var a=h.get;if(void 0===a)return;return a.call(o)}var c=Object.getPrototypeOf(s);if(null===c)return;t=c,e=r,n=o,i=!0,h=c=void 0}},d=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),f=function(){var t=0;return function(){return++t}}(),v=/^(.+) (top|left|right|bottom|center)$/,y=function(){function t(){arguments.length<=0||void 0===arguments[0]?{}:arguments[0];n(this,t)}return d(t,[{key:"on",value:function(t,e,n){var i=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];"undefined"==typeof this.bindings&&(this.bindings={}),"undefined"==typeof this.bindings[t]&&(this.bindings[t]=[]),this.bindings[t].push({handler:e,ctx:n,once:i})}},{key:"once",value:function(t,e,n){this.on(t,e,n,!0)}},{key:"off",value:function(t,e){if("undefined"!=typeof this.bindings&&"undefined"!=typeof this.bindings[t])if("undefined"==typeof e)delete this.bindings[t];else for(var n=0;n<this.bindings[t].length;)this.bindings[t][n].handler===e?this.bindings[t].splice(n,1):++n}},{key:"trigger",value:function(t){if("undefined"!=typeof this.bindings&&this.bindings[t]){for(var e=arguments.length,n=Array(e>1?e-1:0),i=0,s=1;s<e;s++)n[s-1]=arguments[s];for(;i<this.bindings[t].length;){var r=this.bindings[t][i],o=r.handler,h=r.ctx,a=r.once,c=h;"undefined"==typeof c&&(c=this),o.apply(c,n),a?this.bindings[t].splice(i,1):++i}}}}]),t}(),g=function(h){function v(t,e){return n(this,v),p(Object.getPrototypeOf(v.prototype),"constructor",this).call(this,t,e),this.tour=t,this.bindMethods(),this.setOptions(e),this}return e(v,h),d(v,[{key:"bindMethods",value:function(){var t=this,e=["_show","show","hide","isOpen","cancel","complete","scrollTo","destroy","render"];e.map(function(e){t[e]=t[e].bind(t)})}},{key:"setOptions",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=t,this.destroy(),this.id=this.options.id||this.id||"step-"+f();var e=this.options.when;if(e)for(var n in e)if({}.hasOwnProperty.call(e,n)){var i=e[n];this.on(n,i,this)}var h=JSON.stringify(this.options.buttons),a=s(h)||"true"===h,c="{}"===h||"[]"===h||"null"===h||"false"===h,l=!a&&r(this.options.buttons),u=!a&&o(this.options.buttons);a?this.options.buttons=[{text:"Next",action:this.tour.next,classes:"btn"}]:!c&&u?this.options.buttons=[this.options.buttons]:!c&&l||(this.options.buttons=!1)}},{key:"getTour",value:function(){return this.tour}},{key:"bindAdvance",value:function(){var t=this,e=u(this.options.advanceOn,["selector","event"]),n=e.event,i=e.selector,r=function(e){t.isOpen()&&(s(i)?t.el&&e.target===t.el&&t.tour.next():c(e.target,i)&&t.tour.next())};document.body.addEventListener(n,r),this.on("destroy",function(){return document.body.removeEventListener(n,r)})}},{key:"getAttachTo",value:function(){var t=l(this.options.attachTo)||{},e=i({},t);return"string"==typeof t.element&&(e.element=document.querySelector(t.element),e.element||console.error("The element for this Shepherd step was not found "+t.element)),e}},{key:"setupPopper",value:function(){if(s(t))throw new Error("Using the attachment feature of Shepherd requires the Popper.js library");var e=this.getAttachTo();e.modifiers=e.modifiers||{};var n=e.on||"right";s(e.element)&&(e.element=document.querySelector("html"),n="top",e.modifiers=i({offset:"50vh",positionFixed:!0,inner:{enabled:!0},preventOverflow:{enabled:!1,padding:0},hide:{enabled:!1}},e.modifiers));var r=i({},{offset:e.offset||void 0,placement:n,arrowElement:this.el.querySelector(".popper__arrow"),modifiers:e.modifiers},this.options.popperOptions);this.popper&&this.popper.destroy(),this.el.classList.add("shepherd-element"),this.popper=new t(e.element,this.el,r),this.target=e.element,this.target.classList.add("shepherd-target"),this.target.classList.add("shepherd-enabled")}},{key:"show",value:function(){var t=this;if(!s(this.options.beforeShowPromise)){var e=this.options.beforeShowPromise();if(!s(e))return e.then(function(){return t._show()})}this._show()}},{key:"_show",value:function(){var t=this;this.trigger("before-show"),this.el||this.render(),this.el.classList.add("shepherd-open"),document.body.setAttribute("data-shepherd-step",this.id),this.setupPopper(),this.options.scrollTo&&setTimeout(function(){t.scrollTo()}),this.trigger("show")}},{key:"hide",value:function(){this.trigger("before-hide"),this.el.classList.remove("shepherd-open"),document.body.removeAttribute("data-shepherd-step"),this.target&&this.target.classList.remove("shepherd-enabled"),this.popper&&this.popper.destroy(),this.popper=null,this.trigger("hide")}},{key:"isOpen",value:function(){return this.el&&this.el.classList.hasClass("shepherd-open")}},{key:"cancel",value:function(){this.tour.cancel(),this.trigger("cancel")}},{key:"complete",value:function(){this.tour.complete(),this.trigger("complete")}},{key:"scrollTo",value:function(){var t=this.getAttachTo(),e=t.element;s(this.options.scrollToHandler)?s(e)||e.scrollIntoView():this.options.scrollToHandler(e)}},{key:"destroy",value:function(){!s(this.el)&&this.el.parentNode&&(this.el.parentNode.removeChild(this.el),delete this.el),this.popper&&this.popper.destroy(),this.popper=null,this.trigger("destroy")}},{key:"render",value:function(){var t=this;s(this.el)||this.destroy(),this.el=a("<div class='shepherd-step "+(this.options.classes||"")+"' data-id='"+this.id+"' "+(this.options.idAttribute?'id="'+this.options.idAttribute+'"':"")+'><div class="popper__arrow" x-arrow></div>');var e=document.createElement("div");e.className="shepherd-content",this.el.appendChild(e);var n=document.createElement("header");if(e.appendChild(n),this.options.title&&(n.innerHTML+="<h3 class='shepherd-title'>"+this.options.title+"</h3>",this.el.className+=" shepherd-has-title"),this.options.showCancelLink){var i=a("<a href class='shepherd-cancel-link'>âœ•</a>");n.appendChild(i),this.el.className+=" shepherd-has-cancel-link",this.bindCancelLink(i)}s(this.options.text)||!function(){var n=a("<div class='shepherd-text'></div>"),i=t.options.text;"function"==typeof i&&(i=i.call(t,n)),i instanceof HTMLElement?n.appendChild(i):("string"==typeof i&&(i=[i]),i.map(function(t){n.innerHTML+="<p>"+t+"</p>"})),e.appendChild(n)}(),this.options.buttons&&!function(){var n=document.createElement("footer"),i=a("<ul class='shepherd-buttons'></ul>");t.options.buttons.map(function(e){var n=a("<li><a class='shepherd-button "+(e.classes||"")+"'>"+e.text+"</a>");i.appendChild(n),t.bindButtonEvents(e,n.querySelector("a"))}),n.appendChild(i),e.appendChild(n)}(),document.body.appendChild(this.el),this.setupPopper(),this.options.advanceOn&&this.bindAdvance()}},{key:"bindCancelLink",value:function(t){var e=this;t.addEventListener("click",function(t){t.preventDefault(),e.cancel()})}},{key:"bindButtonEvents",value:function(t,e){var n=this;t.events=t.events||{},s(t.action)||(t.events.click=t.action);for(var i in t.events)if({}.hasOwnProperty.call(t.events,i)){var r=t.events[i];"string"==typeof r&&!function(){var t=r;r=function(){return n.tour.show(t)}}(),e.addEventListener(i,r)}this.on("destroy",function(){for(var n in t.events)if({}.hasOwnProperty.call(t.events,n)){var i=t.events[n];e.removeEventListener(n,i)}})}}]),v}(y),b=function(t){function r(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];n(this,r),p(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,e),this.bindMethods(),this.options=e,this.steps=this.options.steps||[];var i=["complete","cancel","hide","start","show","active","inactive"];return i.map(function(e){!function(e){t.on(e,function(n){n=n||{},n.tour=t,m.trigger(e,n)})}(e)}),this}return e(r,t),d(r,[{key:"bindMethods",value:function(){var t=this,e=["next","back","cancel","complete","hide"];e.map(function(e){t[e]=t[e].bind(t)})}},{key:"addStep",value:function(t,e){return s(e)&&(e=t),e instanceof g?e.tour=this:("string"!=typeof t&&"number"!=typeof t||(e.id=t.toString()),e=i({},this.options.defaults,e),e=new g(this,e)),this.steps.push(e),this}},{key:"removeStep",value:function(t){for(var e=this.getCurrentStep(),n=0;n<this.steps.length;++n){var i=this.steps[n];if(i.id===t){i.isOpen()&&i.hide(),i.destroy(),this.steps.splice(n,1);break}}e&&e.id===t&&(this.currentStep=void 0,this.steps.length?this.show(0):this.hide())}},{key:"getById",value:function(t){for(var e=0;e<this.steps.length;++e){var n=this.steps[e];if(n.id===t)return n}}},{key:"getCurrentStep",value:function(){return this.currentStep}},{key:"next",value:function(){var t=this.steps.indexOf(this.currentStep);t===this.steps.length-1?(this.hide(t),this.currentStep=null,this.trigger("complete"),this.done()):this.show(t+1,!0)}},{key:"back",value:function(){var t=this.steps.indexOf(this.currentStep);this.show(t-1,!1)}},{key:"cancel",value:function(){this.currentStep&&(this.currentStep.hide(),this.currentStep=null),this.trigger("cancel"),this.done()}},{key:"complete",value:function(){this.currentStep&&(this.currentStep.hide(),this.currentStep=null),this.trigger("complete"),this.done()}},{key:"hide",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("hide"),this.done()}},{key:"done",value:function(){m.activeTour=null,document.body.classList.remove("shepherd-active"),this.trigger("inactive",{tour:this})}},{key:"show",value:function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]||arguments[1];this.currentStep&&(this.currentStep.hide(),this.currentStep=null),document.body.classList.add("shepherd-active"),this.trigger("active",{tour:this}),m.activeTour=this;var n=void 0;if(n="string"==typeof t?this.getById(t):this.steps[t])if(s(n.options.showOn)||n.options.showOn())this.trigger("show",{step:n,previous:this.currentStep}),this.currentStep=n,n.show();else{var i=this.steps.indexOf(n),r=e?i+1:i-1;this.show(r,e)}}},{key:"start",value:function(){this.trigger("start"),this.currentStep=null,this.next()}}]),r}(y),m=new y;return i(m,{Tour:b,Step:g,Evented:y}),m});